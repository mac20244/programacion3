'use strict';class I18n{constructor(t){this._configs={},this.lang='en',this.baseLang='en',this._desiredLangs=[],this._app=t,this.isMetric=!0,this.DoWMapping={Su:0,Mo:1,Tu:2,We:3,Th:4,Fr:5,Sa:6},this.supportedLocales=['ar','bg','cs','da','de','el','en','es','es-mx','et','fi','fil','fr','hr','hu','id','it','ja','ko','lt','lv','ms','nl','no','pl','pt','pt-br','ro','ru','sk','sl','sr','sv','th','tr','uk','vi','zh','zh-cn','zh-tw'],this.i18nSettings=['clock','rtl']}setLang(t=[]){'string'==typeof t&&(t=t.split(',').map((t=>t.trim()))),t=this._sanitizeLocales(t),this._desiredLangs=this._getLocalesPriorityList(t);const e=Object.keys(this._configs),s=['zh-hk','zh-mo'];let i,n=!1;for(let t=0;t<this._desiredLangs.length;t++){const r=this._desiredLangs[t];if(this.supportedLocales.includes(r)||s.includes(r)){i=r;break}if(e.includes(r)){i=r,n=!0;break}console.log(`'${r}' not defined.`)}if(!i)throw new Error('No supported language is defined. Requested: '+t);this.lang=i;const r=this.lang.split('-')[0];return this.baseLang=r,'zh'===r&&s.includes(this.lang)&&(this.baseLang='zh-tw'),n?this._setTextDirection():this._getTexts(r).then((()=>{this._setTextDirection()})),document.documentElement.setAttribute('lang',this.lang),console.log('Selected locale: '+this.lang),this.lang}async _getTexts(t){let e;try{const s=await fetch(`../texts/${t}.json`);if(200!==s.status)throw new Error(`HTTP Code ${s.status}`);e=await s.json()}catch(e){return void console.log(`Error loading i18n file ${t}.json.\n`+e.message)}Object.entries(e).forEach((([t,e])=>{this.addTexts(t,e,!0)}))}_setTextDirection(){let t='ltr',e='rtl';const s=(this._configs[this.lang]||this._configs[this.baseLang])?.rtl;s&&([t,e]=[e,t]),document.documentElement.setAttribute('dir',t),document.body.classList.add(t),document.body.classList.remove(e),this._app&&(this._app.rtl=s)}_sanitizeLocales(t){const e=/^[a-z]{2,8}(-[a-z0-9]{2,})?$/;return t.map((t=>t&&t.trim().toLowerCase())).filter((t=>e.test(t)))}getString(t,e,s,i){e&&'object'==typeof e&&(i=s);var n=this._configs[this.lang]?.texts[t];if(!n&&this.baseLang!==this.lang&&this._configs[this.baseLang]?.texts&&(n=this._configs[this.baseLang].texts[t]),!n)return i||t;if(!e)return n;if(s)return n.replace(new RegExp(`{${e}}`,'g'),s);if('object'==typeof e){let t=n;return Object.entries(e).forEach((([e,s])=>{t=t.replace(new RegExp(`{${e}}`,'g'),s)})),t}return e&&s?n.replace(new RegExp(`{${e}}`,'g'),s):n}convertKmToMiles(t,e=1){return(.621371*t).toFixed(e)}formatDistance(t,e=!1){var s;return this.isMetric?t<1&&e?(t*=1e3,s=this.getString('M')):s=this.getString('KM'):(t=this.convertKmToMiles(t),s='miles'),`${t} ${s}`}formatAddress(t){return this.getString('ADDRESSMACRO').replace('{addr}',t.location.address||'').replace('{zc}',t.location.zipCode||'').replace('{city}',t.location.city||'')}formatPrice(t,e,s=2){t>=1e3&&t%1<.01&&(s=0);const i=this.priceFormatter&&this.priceFormatter.resolvedOptions();if(i?.currency===e&&i?.maximumFractionDigits===s)return this.priceFormatter.format(t);if(window.Intl&&window.Intl.NumberFormat){const i={style:'currency',currency:e,currencyDisplay:'symbol',maximumFractionDigits:s};return this.priceFormatter=new Intl.NumberFormat(this.lang,i),this.priceFormatter.format(t)}return e+' '+t.toFixed(2)}_getDaysLanguage(){let t=this.lang;return this._configs[t]&&this._configs[t].texts.DAYS||(t=this._configs[this.baseLang]&&this._configs[this.baseLang].texts.DAYS?this.baseLang:'en'),t}getOpeningDays(t){const e=this._getDaysLanguage();try{const s=this._configs[e]?.texts?.DAYS;return s?t.replace(/[a-z]{2}/gi,(t=>s[this.DoWMapping[t]])).replace(/,/g,', ').replace(/-/g,' - '):t}catch(s){const i=`Error in getOpeningDays() - ${s.name}: ${s.message}\tinput: ${t}\tlang: ${e}\tconfigsForLang: ${JSON.stringify(this._configs?.[e])}`;return console.error(i),Tracker.log('error',{msg:i}),''}}getOpeningHours(t){const e=this._getDaysLanguage();try{return t=t.replace(/-/g,' - ').replace(/,/g,', '),this._configs[e]?.clock&&24!==this._configs[e]?.clock?t.replace(/(\d{2})[:hH\.](\d{2})/g,((t,e,s)=>`${parseInt(e,10)%12||12}:${s.padStart(2,'0')} ${e<12?'am':'pm'}`)):t}catch(s){return console.error(`Error in getOpeningHours() - ${s.name}: ${s.message}`,`input: ${t}`,`lang: ${e}`,`configsForLang: ${JSON.stringify(this._configs?.[e])}`),''}}addTexts(t,e={},s=!1){if(t){t=t.toLowerCase();var i={};this.i18nSettings.forEach((t=>{e[t]&&(i[t]=e[t],delete e[t])})),this._configs[t]&&this._configs[t].texts?Object.entries(e).forEach((([e,i])=>{!i||s&&null!=this._configs[t].texts[e]||(this._configs[t].texts[e]=i)})):this._configs[t]={texts:e},Object.entries(i).forEach((([e,s])=>{this._configs[t][e]=s})),s&&t!==this.lang&&t!==this.baseLang||this._resetDefaultLang(t)}else console.error('invalid langage')}_resetDefaultLang(t){if(t===this.lang||t===this.baseLang)return void(this._app&&this._app.forceUpdate());const e=this._desiredLangs.indexOf(this.lang),s=this._desiredLangs.indexOf(t);if(-1!==s&&s<e){const e=this.lang,s=this.baseLang;this.lang=t,this.baseLang=this.lang.split('-')[0],console.debug(`switch lang to '${this.lang}'`),document.documentElement.setAttribute('lang',this.lang),this._app&&(this._app.locale=this.lang,this._app.baseLang=this.baseLang,this._setTextDirection(),this._app.forceUpdate(),this._app.updateLocale(this.lang,e,this.baseLang,s))}}_getLocalesPriorityList(t){let e=[],s=[];t.forEach(((i,n)=>{const r=i.split('-')[0];if(i===r)return;const a=t[n+1],o=a&&a.startsWith(r+'-');t.includes(r)||o||s.includes(r)||(e.push({val:r,idx:n+e.length+1}),s.push(r))}));let i=Utils.clone(t);e.forEach((({val:t,idx:e})=>{i.splice(e,0,t)}));return(navigator.languages||[navigator.language]).map((t=>t.toLowerCase())).forEach((t=>{i.includes(t)||i.push(t)})),i.includes('en')||i.push('en'),i}}
//# sourceMappingURL=i18n.js.map
